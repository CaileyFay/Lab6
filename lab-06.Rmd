---
title: "Lab 06 - Ugly charts and Simpson's paradox"
author: "Cailey Fay"
date: "2/15/26"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox)
library(mosaicData) 
library(ggplot2)
staff <- read_csv("data/instructional-staff.csv")
fisheries <- read_csv("data/fisheries.csv")
```

I think when we convert to long-form data, we will have 6 columns. If there are five different faculty types and 11 years, I think that means we will have 5x11 = 55 rows? 

To get the data long:
```{r}
staff_long <- staff %>%
  pivot_longer(cols = -faculty_type, names_to = "year") %>%
  mutate(value = as.numeric(value))
staff_long
```
This confirms my thought that there would be 55! 

To try to plot this as a line graph with years on the x, the percentage of hires on the y, and 5 lines for the diferent faculty types:
```{r}
staff_long %>%
  ggplot(aes(x = year, y = value, color = faculty_type)) +
  geom_line()
```

This doesn't quite work. 

### Exercise 1

```{r}
staff_long %>%
  ggplot(aes(
    x = year,
    y = value,
    group = faculty_type,
    color = faculty_type
  )) +
  geom_line() +
  labs(title = "Percentage of Faculty Types Hired by Year",
       x= "Year",
       y= "Percentage of Hires",
       color = "Faculty Type")

```

### Exercise 2

Suppose the objective of this plot was to show that the proportion of part-time faculty have gone up over time compared to other instructional staff types. What changes would you propose making to this plot to tell this story?

I would make all of the lines grey except the part time faculty. I think this pretty clearly communicates that the percentage of part time faculty hires is increasing. 
```{r}

staff_long %>%
  ggplot(aes(
    x = year,
    y = value,
    group = faculty_type,
    color = faculty_type
  )) +
  geom_line() +
  labs(title = "Percentage of Faculty Types Hired by Year",
       x= "Year",
       y= "Percentage of Hires",
       color = "Faculty Type") +
    scale_color_manual(values = c(
    "Full-Time Tenured Faculty" = "grey",
    "Full-Time Tenure-Track Faculty" = "grey",
    "Full-Time Non-Tenure-Track Faculty" = "gray",
    "Part-Time Faculty" = "red",
    "Graduate Student Employees" = "grey"
  )) 


```

### Exercise 3
I think it depends on what the point of the visual is, which is sort of unclear because of how ugly and unreadable the graphs are. A graph is going to look very different if we are interested in comparing total volume from country to country, versus if we are interested in the proportion of fish are captured vs farmed for each country. 

The line chart visual looks like it is taking the proportion versus total approach, whereas the pie charts look like they are communicating each country's proportion of the total amount of captured fish and farmed fish. 

To do a better job showing the line chart, I would start by first making it into bars and restricting it to the top-ten heavy hitters in the fish department, in terms of total.This should help make the y scale more reasonable and interpretable, even if we loose a little bit of information about the countries. I also want to convert the data so that we have a 2 rows per country where one is the capture and one is the aquaculture. I am going to reapply the pivot strategy from earlier in the lab.

```{r}
options(scipen = 999) # sick of scientific notation

fisheries_long <- fisheries %>%
  pivot_longer(cols = c("capture","aquaculture"), names_to = "type") %>%
  mutate(value = as.numeric(value))
fisheries_long

top_ten_long <- fisheries_long %>%
  arrange(desc(total)) %>%
  filter(total >= 3878324) #the total of the 10th highest producer 
```
```{r}
ggplot(top_ten_long, mapping = aes(x=fct_reorder(country, total, .desc = FALSE), y=total, fill=type)) +
  geom_col() +
  theme_classic()+
  labs(title = "Proportion of farming and capture in the top-ten producing countries",
       x= "Country",
       y = "Number of Fish",
       fill = "Fishing Type") +
  coord_flip()

#this graph still isn't amazing but it is more readable 
```
Next I will take on those pie charts. I think the plan is to facet by type. I will also switch it to polar coordinates to get it into the pie chart look. The result also isn't awesome but its something 
```{r}
top_ten_long %>%
  filter(type == "capture") %>%
ggplot(top_ten_long, mapping = aes(x=type, y=value, fill = country)) +
geom_col() + 
  coord_polar(theta = "y") + 
  theme_minimal() +
  labs(title = "Number of Captured Fish in the Top-Ten Producing Countries",
       x= "Captured Fish",
       y= element_blank(),
       fill = "Country") 

#dodged_bar_plot + coord_polar()
#I don't know how to get rid of that random "capture" on the side there

```

And I can do the same thing for farmed fish. Faceting was too hard. 
```{r}
top_ten_long %>%
  filter(type == "aquaculture") %>%
ggplot(top_ten_long, mapping = aes(x=type, y=value, fill = country)) +
geom_col() + 
  coord_polar(theta = "y") + 
  theme_minimal() +
  labs(title = "Number of Farmed Fish in the Top-Ten Producing Countries",
       x= "Farmed Fish",
       y= element_blank(),
       fill = "Country") 
#I don't know how to get rid of that random "aquaculture" on the side there
```
...

Add exercise headings as needed.
